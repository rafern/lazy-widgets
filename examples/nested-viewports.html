<!DOCTYPE html>
<html>
    <head>
        <!--
            An import map is not needed if you are using a bundler. You may also
            not include an import map and switch to full paths instead.
        -->
        <script type="importmap">
            {
                "imports": {
                    "lazy-widgets": "../dist/index.js"
                }
            }
        </script>
        <script type='module'>
            import {
                DOMRoot, Label, Margin, Column, Row, TextButton, ScrollbarMode,
                DOMKeyboardDriver, DOMPointerDriver, FlexAlignment, TextInput,
                ScrollableViewportWidget, Alignment, ValidatedVariable,
                AxisCoupling, Background
            } from 'lazy-widgets';

            // Create the root
            const label = new Label('Hello world!');
            const column = new Column();

            const root = new DOMRoot(
                new Background (
                    new ScrollableViewportWidget(
                        new Margin(
                            column.add(
                                new ScrollableViewportWidget(
                                    new Margin(
                                        new Column([
                                            label,
                                            new TextInput(new ValidatedVariable('').watch(variable => {
                                                label.text = `Text input: ${variable.value}`;
                                            })),
                                            new Row([
                                                new TextButton('Button 1'),
                                                new TextButton('Button 2'),
                                            ], {
                                                multiContainerAlignment: {
                                                    main: FlexAlignment.Center,
                                                    cross: Alignment.Stretch
                                                },
                                            }).on('click', (ev) => label.text = `${ev.origin.child.text} clicked!`)
                                        ])
                                    ),
                                    {
                                        minWidth: 170,
                                        minHeight: 50
                                    }
                                )
                            )
                        ),
                        {
                            minWidth: 200,
                            minHeight: 200
                        }
                    )
                )
            );

            for(let i = 1; i <= 20; i++)
                column.add(new Label(`Filler label (${i})`));

            // Create drivers
            const keyboardDriver = new DOMKeyboardDriver();
            const pointerDriver = new DOMPointerDriver();

            // Register roots and bind DOM elements to drivers
            keyboardDriver.bindSingletRoot(root, { domElem: root.domElem });
            root.registerDriver(keyboardDriver);

            pointerDriver.bindDOMElem(root, root.domElem);
            root.registerDriver(pointerDriver);

            // Run the update loop
            function updateLoop() {
                root.update();
                window.requestAnimationFrame(updateLoop);
            }

            window.requestAnimationFrame(updateLoop);

            // Add roots to body
            document.body.appendChild(root.domElem);

        </script>
    </head>
    <body>
        <noscript>
            Please enable Javascript. This example may not work if running via file:// URIs
        </noscript>
    </body>
</html>
